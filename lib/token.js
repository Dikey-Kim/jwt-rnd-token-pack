var jwt=require("jwt-simple"),crypto=require("crypto"),Class=function(){this.generateObjectToken=function(a,c,b){var d=null;a=JSON.stringify(a)+"|"+Date.now();try{d=jwt.encode(a,c)}catch(e){return b(e)}b(null,d)};this.generateRandomToken=function(a,c){crypto.randomBytes(256,function(b,d){var e=null,f=null,g=null;if(b)return c(b);try{e=crypto.createHmac("sha1",a).update(d).digest("hex"),g=e+"|"+Date.now(),f=jwt.encode(g,a)}catch(h){return c(h)}c(null,f)})};this.analyzeAccessToken=function(a,c,b){var d=
null;try{d=jwt.decode(a,c)}catch(e){return b(e)}b(null,d)}};Class.prototype.jwt=jwt;var instance=new Class;module.exports=instance;